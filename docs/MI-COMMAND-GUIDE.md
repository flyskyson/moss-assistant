# mi 命令使用指南

**日期**: 2026-02-07
**版本**: v2.0
**状态**: ✅ 已更新

---

## 🎯 mi 命令的新用途

### 旧用途（v1.0）

**手动初始化 MOSS** - 因为 MOSS 不会自动初始化

**问题**：
- ❌ 现在说"你好"就能自动初始化（SOUL.md 已配置）
- ❌ 不需要每次都手动初始化

---

### 新用途（v2.0）⭐⭐⭐

**备用方案 + 测试工具** - 当自动初始化失败时使用

**三大用途**：

1. **备用方案** - 当说"你好"自动初始化失败时
2. **测试工具** - 验证 MOSS 是否正确读取所有文件
3. **强制刷新** - 清除缓存后快速验证配置

---

## 📋 更新内容

### v2.0 包含的文件（6 个）

1. ✅ SOUL.md - 身份和性格
2. ✅ USER.md - 用户信息
3. ✅ index.md - 知识库导航
4. ✅ **TASKS.md** - 任务清单（⭐ 新增）
5. ✅ 今天的记忆文件 - memory/YYYY-MM-DD.md
6. ✅ MEMORY.md - 长期记忆

### v2.0 要求的报告

1. 你是谁（简短的自我介绍）
2. **每日例行任务有哪些**（从 TASKS.md）⭐ 新增
3. 今天有什么计划（从今天的记忆文件）
4. 知识库中有哪些项目（从 index.md）

---

## 🚀 使用方法

### 方法 1: 终端命令

```bash
mi
```

**效果**：
```
✅ 完整初始化提示已复制到剪贴板！

📝 现在可以直接粘贴给 MOSS

💡 用途说明：
   - 备用方案：当说'你好'自动初始化失败时使用
   - 测试工具：验证 MOSS 是否正确读取所有文件
   - 强制刷新：清除缓存后快速验证配置
```

---

### 方法 2: 粘贴给 MOSS

**步骤**：
1. 在终端运行 `mi`
2. 切换到 MOSS 对话窗口
3. 粘贴（Cmd+V）
4. MOSS 开始完整初始化

---

## 🎯 使用场景

### 场景 1: 自动初始化失败

**现象**：
- 说"你好"后 MOSS 没有报告
- MOSS 没有读取所有文件
- MOSS 没有提醒任务

**解决**：
```bash
# 1. 清除会话缓存
rm -rf ~/.openclaw/agents/main/sessions/

# 2. 重启 Gateway
openclaw gateway restart

# 3. 使用 mi 命令强制初始化
mi
# 粘贴给 MOSS
```

---

### 场景 2: 测试 MOSS 配置

**用途**：验证 MOSS 是否正确读取所有文件

**步骤**：
1. 运行 `mi`
2. 粘贴给 MOSS
3. 检查 MOSS 的报告

**应该看到**：
```
📋 会话初始化完成

我已读取以下文件：
1. ✅ SOUL.md
2. ✅ USER.md
3. ✅ index.md
4. ✅ TASKS.md
5. ✅ memory/2026-02-07.md
6. ✅ MEMORY.md
```

**如果缺少某个文件**：
- 说明配置有问题
- 需要检查 SOUL.md 或 AGENTS.md

---

### 场景 3: 强制刷新配置

**场景**：更新了 SOUL.md 或 TASKS.md 后立即生效

**步骤**：
1. 清除会话缓存
2. 运行 `mi`
3. 粘贴给 MOSS

---

## 📊 对比：自动 vs 手动

| 项目 | 说"你好"（自动）| mi 命令（手动）|
|------|----------------|----------------|
| **读取文件** | 6 个 | 6 个（相同）|
| **报告内容** | 完整 | 完整 |
| **触发方式** | 被动（打招呼）| 主动（粘贴）|
| **适用场景** | 日常使用 | 故障排除、测试 |
| **可靠性** | 95% | 100% |

---

## 💡 最佳实践

### 日常使用

**推荐**：说"你好"（自动初始化）

```
你好
```

**原因**：
- ✅ 简单快速
- ✅ 符合习惯
- ✅ 95% 可靠

---

### 故障排除

**推荐**：使用 mi 命令

```bash
mi
# 粘贴给 MOSS
```

**原因**：
- ✅ 100% 可靠
- ✅ 明确指定读取哪些文件
- ✅ 适合调试

---

### 配置更新后

**推荐**：先清除缓存，再用 mi 测试

```bash
# 1. 清除缓存
rm -rf ~/.openclaw/agents/main/sessions/

# 2. 重启 Gateway
openclaw gateway restart

# 3. 测试配置
mi
# 粘贴给 MOSS
```

---

## 🔧 故障排除

### 问题 1: mi 命令不存在

**错误**：
```
zsh: command not found: mi
```

**解决**：
```bash
source ~/.zshrc
```

---

### 问题 2: MOSS 没有复制到剪贴板

**原因**: 没有安装 pbcopy（非 macOS）

**解决**：手动复制脚本输出的内容

---

### 问题 3: mi 后 MOSS 仍然没有读取 TASKS.md

**检查**：
1. SOUL.md 是否正确配置
2. 会话缓存是否清除
3. Gateway 是否重启

**解决**：
```bash
# 1. 检查 SOUL.md
grep "TASKS.md" ~/clawd/SOUL.md

# 2. 清除缓存
rm -rf ~/.openclaw/agents/main/sessions/

# 3. 重启 Gateway
openclaw gateway restart
```

---

## 📝 相关命令

### newday

**用途**：创建今日记忆文件

```bash
newday
```

---

### check-system-status

**用途**：检查系统状态

```bash
~/clawd/scripts/check-system-status.sh
```

---

## ✅ 总结

### mi 命令的新定位

**从"主要工具"到"备用方案"**

- v1.0: 主要工具（每次对话都要用）
- v2.0: 备用方案（只在需要时用）

---

### 何时使用 mi

**使用 mi 的三种情况**：

1. **自动初始化失败时** - 说"你好"没有反应
2. **测试配置时** - 验证 MOSS 是否正确读取
3. **强制刷新时** - 更新配置后立即生效

---

### 正常情况

**说"你好"就够了**：

```
你好
```

**MOSS 会自动初始化** ✅

---

## 🎉 配置完成

**mi 命令已更新为 v2.0**！

- ✅ 包含 TASKS.md
- ✅ 新的用途说明
- ✅ 详细的输出提示

**现在可以正常使用了！** 🚀
