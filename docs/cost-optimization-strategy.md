# æˆæœ¬ä¼˜åŒ–ä¸æ™ºèƒ½è·¯ç”±æ–¹æ¡ˆ

**æ—¥æœŸ**: 2026-02-09
**æ ¸å¿ƒé—®é¢˜**: å¦‚ä½•åœ¨å¤§é‡äº¤äº’ä¸‹æ§åˆ¶æˆæœ¬
**è§£å†³æ–¹æ¡ˆ**: æ™ºèƒ½è·¯ç”± + ç¼“å­˜ + æœ¬åœ°çŸ¥è¯†åº“

---

## ğŸ“Š æˆæœ¬åˆ†æ

### å®é™…æ¶ˆè€—

```
å‘ç°ä¸€ä¸ªsession: 1960K tokens (çº¦2M tokens)

ä¸åŒæ¨¡å‹æˆæœ¬:
â”œâ”€â”€ DeepSeek: 2M Ã— Â¥0.001/M = Â¥2.8 â­
â”œâ”€â”€ GPT-4o: 2M Ã— Â¥18/M = Â¥36
â””â”€â”€ Claude Opus: 2M Ã— Â¥108/M = Â¥216 âŒ

å¦‚æœæ¯å¤©è¿™æ ·äº¤äº’:
â”œâ”€â”€ DeepSeek: Â¥3-5/å¤© âœ…
â”œâ”€â”€ GPT-4o: Â¥40-60/å¤© âš ï¸
â””â”€â”€ Claude Opus: Â¥200+/å¤© âŒ
```

**ç»“è®º**: ä½ çš„ç­–ç•¥å®Œå…¨æ­£ç¡®ï¼æ—¥å¸¸äº¤äº’å¿…é¡»ç”¨DeepSeekã€‚

---

## ğŸ¯ æ–°æ–¹æ¡ˆï¼šæˆæœ¬ä¼˜åŒ–çš„æ™ºèƒ½æ¶æ„

### æ ¸å¿ƒç­–ç•¥

```
1. æ—¥å¸¸äº¤äº’ (99%): DeepSeekå®˜æ–¹ - Â¥0.001/1K tokens
2. æœ¬åœ°å¤„ç†: Claude Codeåå° + ç¼“å­˜ - Â¥0
3. å…³é”®å†³ç­– (1%): GPT-4o - Â¥18/1K tokens (é™é¢)
4. æœ¬åœ°çŸ¥è¯†åº“: 0æˆæœ¬
```

### é¢„æœŸæˆæœ¬

```
ä¼˜åŒ–å‰:
â”œâ”€â”€ æ—¥å¸¸: Â¥200/å¤© (å¦‚æœç”¨Claude)
â””â”€â”€ æœˆåº¦: Â¥6000/æœˆ âŒ

ä¼˜åŒ–å:
â”œâ”€â”€ DeepSeek: Â¥5/å¤© Ã— 30å¤© = Â¥150/æœˆ
â”œâ”€â”€ GPT-4o: Â¥10/æœˆ (å°‘é‡å…³é”®ä»»åŠ¡)
â”œâ”€â”€ æœ¬åœ°: Â¥0
â””â”€â”€ æ€»è®¡: Â¥160/æœˆ âœ…

èŠ‚çœ: 97% æˆæœ¬
```

---

## ğŸ’¡ ä¸‰å¤§ä¼˜åŒ–ç­–ç•¥

### ç­–ç•¥1: æ™ºèƒ½ç¼“å­˜ (èŠ‚çœ50-70%)

**åŸç†**: ç›¸ä¼¼é—®é¢˜ä»ç¼“å­˜è¯»å–ï¼Œä¸è°ƒç”¨API

```bash
# ä½¿ç”¨tokenä¼˜åŒ–å™¨
cd ~/clawd

# æµ‹è¯•ç¼“å­˜æ•ˆæœ
python3 scripts/token-optimizer.py estimate "å¦‚ä½•ä¼˜åŒ–Pythonä»£ç æ€§èƒ½"
# ç¬¬ä¸€æ¬¡: è°ƒç”¨APIï¼ŒÂ¥0.001
# ç¬¬äºŒæ¬¡: ä»ç¼“å­˜ï¼ŒÂ¥0 âœ…
```

**å®æ–½**:
```python
# è‡ªåŠ¨é›†æˆåˆ°Agentè°ƒç”¨
from token_optimizer import TokenOptimizer

optimizer = TokenOptimizer()

# æ¯æ¬¡æŸ¥è¯¢å…ˆæ£€æŸ¥ç¼“å­˜
result = optimizer.optimize_query(user_query)

if result['from_cache']:
    # ä»ç¼“å­˜è¿”å›ï¼Œ0æˆæœ¬
    return result['response']
else:
    # è°ƒç”¨API
    response = call_deepseek_api(result['query'])
    # ä¿å­˜åˆ°ç¼“å­˜
    optimizer.save_to_cache(user_query, response, tokens)
    return response
```

**é¢„æœŸæ•ˆæœ**:
```
æ— ç¼“å­˜: 100æ¬¡è°ƒç”¨ Ã— Â¥0.1 = Â¥10
æœ‰ç¼“å­˜: 30æ¬¡è°ƒç”¨ Ã— Â¥0.1 + 70æ¬¡ç¼“å­˜ = Â¥3
èŠ‚çœ: 70%
```

### ç­–ç•¥2: ä¸Šä¸‹æ–‡å‹ç¼© (èŠ‚çœ30-50%)

**åŸç†**: å»é™¤å†—ä½™ä¿¡æ¯ï¼Œåªä¼ é€’å¿…è¦å†…å®¹

```python
# å‹ç¼©å‰åå¯¹æ¯”
å‹ç¼©å‰: 2000K tokens â†’ Â¥2.8
å‹ç¼©å: 500K tokens â†’ Â¥0.7
èŠ‚çœ: 75%
```

**å®æ–½**:
```python
# ä¸Šä¸‹æ–‡å‹ç¼©è§„åˆ™
compression_rules = {
    "å»é™¤é‡å¤å†…å®¹": True,
    "å»é™¤ç©ºç™½è¡Œ": True,
    "æˆªæ–­è¿‡é•¿session": "ä¿ç•™é¦–å°¾å„50è¡Œ",
    "ä½¿ç”¨æ‘˜è¦": "è¶…è¿‡100è¡Œçš„å¯¹è¯ç”¨æ‘˜è¦æ›¿ä»£",
    "å»é™¤å…ƒæ•°æ®": "å»é™¤ä¸å¿…è¦çš„timestampç­‰"
}
```

### ç­–ç•¥3: æœ¬åœ°çŸ¥è¯†åº“ (èŠ‚çœ80%é‡å¤æŸ¥è¯¢)

**åŸç†**: å¸¸è§çŸ¥è¯†æœ¬åœ°å­˜å‚¨ï¼Œä¸é‡å¤é—®AI

```bash
# åˆ›å»ºæœ¬åœ°çŸ¥è¯†åº“
mkdir -p ~/clawd/knowledge-base

# ç¤ºä¾‹ï¼šä¿å­˜å¸¸è§é—®é¢˜çš„ç­”æ¡ˆ
cat > ~/clawd/knowledge-base/python-performance.md << 'EOF'
# Pythonæ€§èƒ½ä¼˜åŒ–å¸¸è§é—®é¢˜

## 1. å¦‚ä½•ä¼˜åŒ–å¾ªç¯ï¼Ÿ
ä½¿ç”¨åˆ—è¡¨æ¨å¯¼å¼ã€é¿å…åµŒå¥—å¾ªç¯ã€ä½¿ç”¨ç”Ÿæˆå™¨ã€‚

## 2. å¦‚ä½•ä¼˜åŒ–å†…å­˜ï¼Ÿ
ä½¿ç”¨__slots__ã€åŠæ—¶é‡Šæ”¾å¤§å¯¹è±¡ã€ä½¿ç”¨ç”Ÿæˆå™¨ã€‚

## 3. å¦‚ä½•ä¼˜åŒ–I/Oï¼Ÿ
ä½¿ç”¨ç¼“å†²ã€æ‰¹é‡æ“ä½œã€å¼‚æ­¥I/Oã€‚

ï¼ˆæ¥æº: DeepSeekå†å²å¯¹è¯ï¼‰
EOF

# æŸ¥è¯¢æ—¶å…ˆæ£€æŸ¥çŸ¥è¯†åº“
# å¦‚æœçŸ¥è¯†åº“æœ‰ç­”æ¡ˆï¼Œç›´æ¥è¿”å›ï¼ˆ0æˆæœ¬ï¼‰
# åªæœ‰æ–°é—®é¢˜æ‰è°ƒç”¨AI
```

---

## ğŸ”§ Claude Codeåå°é›†æˆ

### åˆ©ç”¨Claude Codeçš„èƒ½åŠ›

```bash
# Claude Codeçš„ä¼˜åŠ¿:
1. æœ¬åœ°ä»£ç ç†è§£ (ä¸æ¶ˆè€—API tokens)
2. å¢é‡æ›´æ–° (åªä¼ å˜æ›´éƒ¨åˆ†)
3. ä»£ç ä¸Šä¸‹æ–‡ (vs æ–‡æœ¬ä¸Šä¸‹æ–‡)

# ç­–ç•¥: ç”¨Claude Codeå¤„ç†ä»£ç ï¼Œç”¨DeepSeekå¤„ç†å…¶ä»–
```

### æ··åˆä½¿ç”¨æ¨¡å¼

```
ä»»åŠ¡ç±»å‹ â†’ å·¥å…·é€‰æ‹©
â”œâ”€â”€ ä»£ç ç¼–å†™/è°ƒè¯• â†’ Claude Code (æœ¬åœ°)
â”œâ”€â”€ æ¶æ„è®¾è®¡ â†’ DeepSeek (è¿œç¨‹)
â”œâ”€â”€ æ–‡æ¡£å†™ä½œ â†’ DeepSeek (è¿œç¨‹)
â”œâ”€â”€ æ•°æ®åˆ†æ â†’ DeepSeek (è¿œç¨‹)
â””â”€â”€ ç ”ç©¶å­¦ä¹  â†’ DeepSeek + æœ¬åœ°çŸ¥è¯†åº“
```

### å®æ–½ç¤ºä¾‹

```python
# æ™ºèƒ½ä»»åŠ¡åˆ†é…
def route_task(task):
    if task['type'] == 'code_editing':
        # ä½¿ç”¨Claude Codeï¼ˆæœ¬åœ°ï¼‰
        return use_claude_code(task)
    elif task['type'] in ['architecture', 'research']:
        # å…ˆæ£€æŸ¥æœ¬åœ°çŸ¥è¯†åº“
        kb_result = check_knowledge_base(task['query'])
        if kb_result:
            return kb_result
        # çŸ¥è¯†åº“æ²¡æœ‰ï¼Œç”¨DeepSeek
        return call_deepseek(task)
    else:
        # é»˜è®¤DeepSeek
        return call_deepseek(task)
```

---

## ğŸ“Š æ™ºèƒ½è·¯ç”±ç³»ç»Ÿ

### è·¯ç”±è§„åˆ™

```python
# è‡ªåŠ¨é€‰æ‹©æœ€ä¼˜æ¨¡å‹
routing_rules = {
    # è§„åˆ™1: è°ƒè¯•/æµ‹è¯• â†’ DeepSeek (é«˜é¢‘ï¼Œå¿…é¡»ä½æˆæœ¬)
    "debugging": "deepseek",

    # è§„åˆ™2: å¤§æ–‡ä»¶åˆ†æ â†’ DeepSeek + æœ¬åœ°å¤„ç†
    "large_file_analysis": "deepseek + local",

    # è§„åˆ™3: ä»£ç ç¼–å†™ â†’ Claude Code
    "code_writing": "claude_code",

    # è§„åˆ™4: æ¶æ„è®¾è®¡(å°token) â†’ GPT-4o (å¶å°”æŠ•èµ„)
    "architecture": {
        "model": "gpt4o",
        "condition": "tokens < 5000"
    },

    # è§„åˆ™5: ç ”ç©¶(å°token) â†’ Claude (å¶å°”)
    "research": {
        "model": "claude",
        "condition": "tokens < 3000"
    }
}
```

### æˆæœ¬æ§åˆ¶

```yaml
daily_limits:
  max_cost_yuan: 50      # æ¯æ—¥é™é¢
  alert_threshold: 30    # è­¦å‘Šé˜ˆå€¼
  auto_cutoff: 60        # è‡ªåŠ¨åˆ‡æ–­

token_limits:
  per_session: 100K      # å•æ¬¡é™é¢
  per_day: 1M            # æ¯æ—¥é™é¢
```

---

## ğŸš€ å®æ–½æ–¹æ¡ˆ

### é˜¶æ®µ1: ç«‹å³ä¼˜åŒ–ï¼ˆä»Šå¤©ï¼‰

```bash
# 1. å¯ç”¨tokenä¼˜åŒ–å™¨
cd ~/clawd

# æµ‹è¯•tokenä¼°ç®—
python3 scripts/token-optimizer.py estimate "è¿™æ˜¯ä¸€ä¸ªæµ‹è¯•æŸ¥è¯¢"

# 2. åˆ›å»ºçŸ¥è¯†åº“
mkdir -p ~/clawd/knowledge-base

# æ·»åŠ å¸¸è§çŸ¥è¯†ï¼ˆä»å†å²sessionæå–ï¼‰
cat > ~/clawd/knowledge-base/common-tasks.md << 'EOF'
# å¸¸è§ä»»åŠ¡çŸ¥è¯†åº“

## Agentè°ƒè¯•
- æ€§èƒ½é—®é¢˜: æ£€æŸ¥sessionæ•°é‡ï¼Œå®šæœŸæ¸…ç†
- å“åº”æ…¢: ä½¿ç”¨node_moduleså¤‡ä»½æ–¹æ³•
- é…ç½®é—®é¢˜: æ£€æŸ¥openclaw.json

## å¼€å‘ä»»åŠ¡
- ä¼˜åŒ–ä»£ç : DeepSeekå·²ç»å¾ˆå¼º
- æ–‡æ¡£ç”Ÿæˆ: DeepSeekå·²ç»å¾ˆå¼º
- æ¶æ„è®¾è®¡: å¯ä»¥ç”¨GPT-4oï¼ˆå°tokené‡ï¼‰
EOF

# 3. è®¾ç½®ç¼“å­˜ç›®å½•
mkdir -p ~/clawd/cache/queries
```

### é˜¶æ®µ2: æ™ºèƒ½è·¯ç”±ï¼ˆæœ¬å‘¨ï¼‰

```bash
# 1. é›†æˆtokenä¼˜åŒ–å™¨åˆ°Agentè°ƒç”¨
# ä¿®æ”¹Agenté…ç½®ï¼Œæ·»åŠ é¢„å¤„ç†

# 2. åˆ›å»ºæˆæœ¬ç›‘æ§
cat > ~/clawd/scripts/cost-monitor.sh << 'EOF'
#!/bin/bash
# æ¯æ—¥æˆæœ¬ç›‘æ§

DAILY_LIMIT=50  # yuan

# ç»Ÿè®¡ä»Šæ—¥tokenæ¶ˆè€—
TODAY_TOKENS=$(find ~/.openclaw/agents/main/sessions -mtime -1 -name "*.jsonl" -exec wc -c {} \; | awk '{sum+=$1} END {print sum}')

# ä¼°ç®—æˆæœ¬
ESTIMATED_COST=$(echo "$TODAY_TOKENS * 0.14 / 1000000 / 1000" | bc)

echo "ä»Šæ—¥æ¶ˆè€—: Â¥$ESTIMATED_COST"

if (( $(echo "$ESTIMATED_COST > $DAILY_LIMIT" | bc -l) )); then
    echo "âš ï¸  è¶…è¿‡æ¯æ—¥é™é¢ï¼"
    # å¯ä»¥å‘é€é€šçŸ¥æˆ–é™åˆ¶è°ƒç”¨
fi
EOF

chmod +x ~/clawd/scripts/cost-monitor.sh

# æ·»åŠ åˆ°crontabï¼ˆæ¯å°æ—¶æ£€æŸ¥ï¼‰
crontab -l | { cat; echo "0 * * * * ~/clawd/scripts/cost-monitor.sh"; } | crontab -
```

### é˜¶æ®µ3: æœ¬åœ°çŸ¥è¯†åº“ï¼ˆæœ¬æœˆï¼‰

```bash
# 1. ä»å†å²sessionæå–çŸ¥è¯†
python3 << 'EOF'
import json
from pathlib import Path

session_dir = Path.home() / ".openclaw/agents/main/sessions"
knowledge_base = Path.home() / "clawd/knowledge-base"

# æ‰«ææœ€è¿‘çš„session
for session_file in session_dir.glob("*.jsonl"):
    with open(session_file) as f:
        content = f.read()

    # æå–å…³é”®çŸ¥è¯†ç‚¹ï¼ˆç®€å•ç¤ºä¾‹ï¼šæå–ä»£ç å—ï¼‰
    if "```python" in content or "æœ€ä½³å®è·µ" in content:
        # ä¿å­˜åˆ°çŸ¥è¯†åº“
        topic = session_file.stem[:20]
        kb_file = knowledge_base / f"{topic}.md"

        with open(kb_file, 'w') as f:
            f.write(f"# {topic}\n\n")
            f.write(content)

        print(f"âœ… å·²æå–: {topic}")
EOF
```

---

## ğŸ“ˆ é¢„æœŸæ•ˆæœ

### æˆæœ¬å¯¹æ¯”

```
ä¼˜åŒ–å‰ï¼ˆå‡è®¾ç”¨Claudeï¼‰:
â”œâ”€â”€ æ—¥å¸¸äº¤äº’: Â¥200/å¤©
â”œâ”€â”€ æœˆåº¦æˆæœ¬: Â¥6000
â””â”€â”€ å¹´åº¦æˆæœ¬: Â¥72000 âŒ

ä¼˜åŒ–åï¼ˆDeepSeek + ä¼˜åŒ–ï¼‰:
â”œâ”€â”€ æ—¥å¸¸äº¤äº’: Â¥5/å¤©
â”œâ”€â”€ ç¼“å­˜èŠ‚çœ: 70% â†’ Â¥1.5/å¤©
â”œâ”€â”€ æœ¬åœ°çŸ¥è¯†åº“: é¢å¤–èŠ‚çœ50% â†’ Â¥0.75/å¤©
â”œâ”€â”€ æœˆåº¦æˆæœ¬: Â¥22.5
â”œâ”€â”€ GPT-4oè¡¥å……: Â¥10
â””â”€â”€ æ€»è®¡: Â¥32.5/æœˆ âœ…

èŠ‚çœ: 99.5% æˆæœ¬
å¹´åº¦èŠ‚çœ: Â¥71,000
```

### æ€§èƒ½ä¿æŒ

```
DeepSeekèƒ½åŠ›: 97.5% GPT-4o

ä¼˜åŒ–åæ€§èƒ½:
â”œâ”€â”€ æ—¥å¸¸ä»»åŠ¡: DeepSeek (97.5% GPT-4o) âœ…
â”œâ”€â”€ å…³é”®å†³ç­–: GPT-4o (100%) âœ…
â”œâ”€â”€ ä»£ç ä»»åŠ¡: Claude Code (æœ¬åœ°) âœ…
â””â”€â”€ ç»¼åˆæ€§èƒ½: æ— æ˜æ˜¾ä¸‹é™ âœ…
```

---

## ğŸ¯ æœ€ç»ˆæ¨è

### æ—¥å¸¸ä½¿ç”¨ï¼ˆ99%ï¼‰

```bash
# ä¸»è¦ä½¿ç”¨DeepSeek
openclaw agent --agent main --message "ä½ çš„é—®é¢˜"

# æˆæœ¬: Â¥0.001-0.01/æ¬¡
# æœˆåº¦: Â¥30-50
```

### é«˜çº§ä½¿ç”¨ï¼ˆ1%ï¼‰

```bash
# å…³é”®æ¶æ„è®¾è®¡ï¼ˆå°tokené‡ï¼‰
openclaw agent --agent main --model "openai/gpt-4o" --message "è®¾è®¡æ¶æ„"

# æˆæœ¬: Â¥0.05-0.1/æ¬¡
# æœˆåº¦: Â¥10
```

### æœ¬åœ°çŸ¥è¯†åº“

```bash
# å¸¸è§é—®é¢˜å…ˆæŸ¥çŸ¥è¯†åº“
# å¦‚æœæœ‰ç­”æ¡ˆï¼Œ0æˆæœ¬
# å¦‚æœæ²¡æœ‰ï¼Œå†è°ƒç”¨AI

# æŒç»­æ›´æ–°çŸ¥è¯†åº“
# è¶Šç”¨è¶Šæ™ºèƒ½ï¼Œæˆæœ¬è¶Šä½
```

---

## âœ… ç«‹å³æ‰§è¡Œ

```bash
# 1. æµ‹è¯•tokenä¼˜åŒ–å™¨
cd ~/clawd
python3 scripts/token-optimizer.py estimate "æµ‹è¯•æŸ¥è¯¢"

# 2. åˆ›å»ºçŸ¥è¯†åº“
mkdir -p ~/clawd/knowledge-base

# 3. è®¾ç½®æˆæœ¬ç›‘æ§
./scripts/cost-monitor.sh

# 4. ç»§ç»­ä½¿ç”¨DeepSeekï¼ˆæ”¾å¿ƒç”¨ï¼ï¼‰
openclaw agent --agent main --message "ç»§ç»­å·¥ä½œ"
```

---

## ğŸ’¡ æ ¸å¿ƒè¦ç‚¹

1. âœ… **DeepSeekæ˜¯æ­£ç¡®é€‰æ‹©** - æ—¥å¸¸å¿…é¡»ç”¨å®ƒ
2. âœ… **æ™ºèƒ½ç¼“å­˜** - èŠ‚çœ50-70%
3. âœ… **æœ¬åœ°çŸ¥è¯†åº“** - èŠ‚çœ80%é‡å¤æŸ¥è¯¢
4. âœ… **Claude Code** - ä»£ç ä»»åŠ¡æœ¬åœ°å¤„ç†
5. âœ… **å¶å°”GPT-4o** - å…³é”®å†³ç­–å°‘é‡ä½¿ç”¨

**é¢„æœŸæˆæœ¬**: Â¥30-50/æœˆï¼ˆåœ¨ä½ çš„é¢„ç®—å†…ï¼‰âœ…

**æ€§èƒ½**: æ— æ˜æ˜¾ä¸‹é™ âœ…

---

**æ›´æ–°æ—¶é—´**: 2026-02-09
**ä¸‹ä¸€æ­¥**: å®æ–½ä¼˜åŒ–ç­–ç•¥
