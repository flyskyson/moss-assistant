# HEARTBEAT.md - MOSS 主动任务清单

**配置时间**: 2026-02-05
**状态**: 已启用

---

## 📋 定期任务（轮流执行）

### 🔴 每日例行任务（继承自 TASKS.md）

**每日记忆创建**（每天 1 次，建议时间：7:00）
- [ ] 执行 `newday` 命令
  ```bash
  newday
  ```
- [ ] 检查记忆文件创建成功
- [ ] 更新 TASKS.md 中的相关项目状态

**系统健康检查**（每天 1 次，建议时间：9:00）
- [ ] 检查 OpenClaw Gateway 状态
  ```bash
  openclaw status
  ```
- [ ] 检查 Memory 索引状态
  ```bash
  openclaw memory status
  ```
- [ ] 检查磁盘空间（工作区占用）
- [ ] 检查最近的错误日志

**主动性引擎健康检查**（每天 1 次，建议时间：12:00）
- [ ] 执行主动性引擎报告
  ```bash
  cd /Users/lijian/clawd
  ./scripts/proactive-engine-control.sh main report
  ```
- [ ] 记录关键发现到 memory/YYYY-MM-DD.md
- [ ] 如有紧急问题（🔴级别），立即在会话中提报
- [ ] 如有重要问题（🟡级别），在下次会话中提报

**每日AI技术简报生成**（每天 1 次，建议时间：10:00）
- [ ] 执行简报生成脚本
  ```bash
  node /Users/lijian/clawd/skills/daily-briefing/briefing.js
  ```
- [ ] 检查简报输出文件
  ```bash
  cat /Users/lijian/clawd/outputs/daily-briefing/latest.md
  ```
- [ ] 验证简报质量（OpenClaw新闻/AI动态/GitHub趋势）

**每日深度研究**（每天 1 次，建议时间：14:00）
- [ ] 基于飞天性格分析进行全网深度研究
- [ ] 搜索符合飞天性格、意愿的材料、工具、想法、技能
- [ ] 生成深度研究报告
  ```bash
  # 研究报告保存路径
  /Users/lijian/clawd/reports/daily-research/YYYY-MM-DD-report.md
  ```
- [ ] 在次日heartbeat时间提供报告摘要

**知识库导航索引更新**（每天 1 次，建议时间：23:00）
- [ ] 读取 index.md 文件列表
- [ ] 验证所有记录的文件是否存在
- [ ] 检查 docs/, projects/, scripts/ 等目录是否有遗漏
- [ ] 如发现不一致 → 记录到日志并向你提报
- [ ] 输出维护日志
  ```bash
  cat /Users/lijian/clawd/logs/index-maintenance.log
  ```

**配置主动性检查**（每周 1 次，建议时间：周一 9:00）
- [ ] 读取 SOUL.md、USER.md、IDENTITY.md 等核心配置文件
- [ ] 评估配置健康状态（一致性、时效性、完整性、准确性）
- [ ] 如发现问题，准备在下一次会话中提出优化建议
- [ ] 记录检查结果到当天的记忆文件

**勿扰时段**: 23:30 - 7:00（不执行）

---

### 🟡 中优先级（每 3 天）

**每日自动复盘**（每天 1 次，已配置 Cron：23:30）
- ✅ **已配置自动脚本**：`/Users/lijian/clawd/scripts/daily-retrospect.sh`
- ✅ **已配置 Cron 任务**：每天 23:30 自动执行
- [ ] 检查复盘报告生成状态
- [ ] 验证报告数据准确性
- [ ] 必要时手动调整复盘逻辑

**每日对话摘要**（每天 1 次，建议时间：凌晨 4:00）
- [ ] 获取过去 24 小时的对话历史
- [ ] AI 分析并提炼关键决策、待办事项和知识点
- [ ] 将摘要追加到前一天的每日记忆文件中
- [ ] 如发现长期价值内容，准备在下一次会话中向你提报

**记忆维护**（每 3 天执行一次）
- [ ] 读取最近 7 天的 memory/*.md 文件
- [ ] 提取重要事件和决策
- [ ] 更新 MEMORY.md（长期记忆）
- [ ] 删除或归档过时的长期记忆
- [ ] 更新 memory/maintenance.json

**执行时机**: 建议在晚上 20:00-23:00

---

### 🟢 低优先级（每周）

**知识推荐**（每周 1 次）
- [ ] 搜索 AI 领域的最新进展
  - OpenClaw 更新
  - DeepSeek 新特性
  - Multi-Agent 实践案例
- [ ] 推荐值得学习的文章/工具
- [ ] 预告可能需要的新技能

**文档整理**（每周 1 次）
- [ ] 检查工作区文档结构
- [ ] 更新过时的配置信息
- [ ] 归档旧文件
- [ ] 清理重复内容

**主动学习 (MOSS Active Learning)**（每周 1-2 次）
- [ ] 随机读取 1-2 份 `docs/` 或 `memory/` 中的文档
- [ ] 学习和理解你的思考和决策模式
- [ ] 将学习心得内部消化，用于未来更好地辅助你

---

## 🎯 重要待办事项

### 🔴 紧急

- [x] **修复飞书权限**（错误代码：99991672）✅ 已完成
  - ✅ 用户已在飞书开放平台开通 `cardkit:card:write` 权限
  - ✅ 安全配置已优化：`dmPolicy` 改为 `pairing` 模式
  - ✅ 配置验证：`allowFrom` 已清空（从 `["*"]` 改为 `[]`）
  - ✅ Gateway 自动重载配置生效
  - ✅ 飞书 WebSocket 连接正常

### ✅ 已完成

- [x] **启用 Leader Agent（Multi-Agent Phase 2）** ✅ 已完成
  - ✅ 清理冗余 agents（leader-agent、utility-agent）
  - ✅ 创建新版 agents（leader-agent-v2、utility-agent-v2）
  - ✅ 配置 sessions_spawn 权限
  - ✅ Gateway 重启生效
  - ✅ 全面测试验证通过（2026-02-08）

- [x] **建立主动性机制** ✅ 已完成
  - ✅ 创建主动性检查清单和触发条件
  - ✅ 定义配置健康检查标准
  - ✅ 更新 SOUL.md 和 MEMORY.md
  - ✅ 添加到 HEARTBEAT 定期任务

- [x] **TASKS.md 优化整合** ✅ 已完成
  - ✅ 将每日例行任务迁移到 HEARTBEAT.md
  - ✅ 重构 TASKS.md 为项目管理清单
  - ✅ 明确职能边界（HEARTBEAT=自动任务，TASKS=项目管理）
  - ✅ 执行时间：2026-02-08 10:22

### 🟡 待规划

- [x] **创建配置健康检查脚本** ✅ 已完成（2026-02-08）
- [x] **配置自动化备份脚本** ✅ 已完成（2026-02-08）
- [x] **建立知识库系统** ✅ 已完成（2026-02-08）
  - ✅ PARA 结构完整（docs, projects, scripts, skills, memory）
  - ✅ 50+ 维护文档，15+ 工具脚本
  - ✅ 自进化知识库引擎（监控+分类+更新+优化）
  - ✅ Multi-Agent 协作集成

---

## 📊 执行日志

| 日期 | 执行任务 | 状态 | 备注 |
|------|---------|------|------|
| 2026-02-05 | 配置心跳任务 | ✅ 完成 | 首次配置 |
| 2026-02-08 | Multi-Agent 架构测试 | ✅ 完成 | leader-agent-v2 和 utility-agent-v2 验证通过 |
| 2026-02-08 | 主动性机制建立 | ✅ 完成 | 添加检查清单和健康标准 |
| 2026-02-08 | TASKS.md 优化整合 | ✅ 完成 | 重构为项目管理清单 |
| 2026-02-08 | 自动化备份系统 | ✅ 完成 | 脚本创建、Cron 配置、测试通过 |
| 2026-02-08 | 子 Agents 记忆激活 | ✅ 完成 | 记忆目录 + 任务记录集成 |
| 2026-02-08 | 自进化知识库引擎 | ✅ 完成 | 监控+分类+更新+优化+Multi-Agent集成 |
| 2026-02-08 | 项目状态跟踪器 | ✅ 完成 | project-tracker.py + 自动化记录 |
| 2026-02-08 | Cron 测试验证 | ✅ 完成 | 验证 6 个 cron 任务全部正常 |
| 2026-02-08 | 每日复盘系统创建 | ✅ 完成 | 脚本 + 模板 + Cron + 测试 |
| 2026-02-08 | Cron任务勿扰时段优化 | ✅ 完成 | 知识库监控22→23，添加复盘23:30，调整index维护 |
| 2026-02-09 | 主动性引擎HEARTBEAT集成 | ✅ 完成 | 添加每日主动性引擎健康检查任务 |
| 2026-02-09 | 主动性引擎健康检查 | ✅ 完成 | 20:38执行，系统运行正常 |
| 2026-02-09 | 系统健康检查 | ✅ 完成 | 22:21执行，Gateway运行正常，磁盘空间正常 |
| 2026-02-09 | 知识库索引维护 | ✅ 完成 | 22:22执行，检测到214个新文件 |
| 2026-02-10 | 每日记忆检查 | ✅ 完成 | 07:11执行，记忆文件已存在 |
| 2026-02-10 | 系统健康检查 | ✅ 完成 | 07:11执行，Gateway运行正常，磁盘空间正常 |
| 2026-02-10 | 主动性引擎检查 | ✅ 完成 | 07:12执行，引擎运行正常，Session平均10.6个 |
| 2026-02-10 | 记忆维护 | ✅ 完成 | 07:25执行，检查最近7天记忆文件，MEMORY.md已更新 |
| 2026-02-10 | 每日AI技术简报生成 | ✅ 完成 | 09:56执行，简报已生成并保存到briefings/2026-02-10.md |

---

## 💡 使用说明

**MOSS 的行为**：
- 每次心跳时，读取这个文件
- 按优先级执行任务
- 跳过勿扰时段
- 记录执行结果

**你的作用**：
- 根据实际情况调整优先级
- 添加新的周期性任务
- 定期回顾执行日志

---

**原理**: 心跳机制让 MOSS 从"被动响应"变为"主动协作"，真正实现认知伙伴关系。

**下次回顾**: 2026-02-11（3 天后）
# 测试修改 Mon Feb  9 11:36:32 CST 2026