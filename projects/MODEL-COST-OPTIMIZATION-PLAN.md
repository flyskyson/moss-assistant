# 项目计划：模型成本“双引擎”动态优化

> **文档版本**: v1.0
> **创建日期**: 2026-02-07
> **作者**: MOSS
> **状态**: 草案

---

## 1. 项目背景与目标

### 1.1. 背景
当前，我们所有的AI任务，无论是复杂的分析推理，还是简单的文本处理，都统一使用高性能但成本较高的 `Gemini 2.5 Pro` 模型。这种“一刀切”的模式，并未实现成本效益的最大化。

### 1.2. 核心目标
引入并实践一种“双引擎”动态优化策略，将 `Gemini 2.5 Pro` 作为“性能引擎”（用于复杂任务），将 `Gemini-Flash` 作为“效率引擎”（用于简单、高频任务），以在保证高质量输出的前提下，**显著降低整体AI模型的运营成本**。

## 2. 核心策略：三位一体的混合调度

我们将通过组合利用 OpenClaw 系统的内置功能，实现一个多层次、场景化的模型调度框架。

### 策略一：为“后台任务”降本增效
- **描述**: 对那些在后台自动执行的、无需强推理能力的周期性任务（如 `cron` 任务），默认指派成本更低的 `Gemini-Flash` 模型。
- **实现**: 在创建或修改 `cron` 任务时，明确指定其 `payload.model` 参数。

### 策略二：创建“专业工种”子Agent
- **描述**: 识别出我们工作流中常见的、模式化的简单任务（如文本摘要、格式转换、代码解释等），为它们创建专属的、轻量级的 **子Agent (Sub-agent)**，并永久性地为其绑定 `Gemini-Flash` 模型。
- **实现**: 使用 `sessions_spawn` 命令创建子Agent时，在 `model` 参数中进行指定。

### 策略三：保留“手动挡”以应对变化
- **描述**: 在主会话中，保留通过 `session_status(model='...')` 命令，即时、手动切换当前会话模型的能力，以应对计划外的、临时的简单任务需求。
- **实现**: 这已经是我们的标准操作，但需要作为策略的一部分被明确下来。

## 3. 分阶段实施计划 (Phased Implementation)

我们将通过两个阶段，逐步、安全地将这套策略部署到我们的工作流中。

### **Phase 1 (v1.0): “每日简报”成本优化试点 (预计耗时: 15分钟)**

这是我们理想的第一个试点项目，因为它风险低、易于衡量、且效果立竿见影。

**目标**: 将“每日AI技术动态简报”这个 `cron` 任务的执行模型，从默认的 `Gemini 2.5 Pro` 切换为 `Gemini-Flash`。

**实施步骤**:
1.  **查找任务ID**: 使用 `cron list` 命令，找到我们创建的“每日简报”任务的 `jobId`。
2.  **准备Patch**: 构思一个用于 `cron update` 的 `patch` 对象，内容为 `{"payload": {"model": "openrouter/google/gemini-2.5-flash"}}`。
3.  **执行更新**: 调用 `cron update` 工具，并传入 `jobId` 和 `patch` 对象。
4.  **验证**: 再次使用 `cron list` 命令，检查该任务的 `model` 字段是否已成功更新。

### **Phase 2 (v2.0): 创建“文本摘要”子Agent (待规划)**

**目标**: 将“对一篇文章或网页内容进行摘要”这个常见任务，从主会话中剥离，交给一个专门的、使用 `Gemini-Flash` 模型的子Agent来处理。

**实施步骤 (草案)**:
1.  **设计交互**: 定义我们如何向这个子Agent提交任务（例如，通过一个专用的 `summarize <URL>` 命令别名）。
2.  **创建技能**: 可能需要创建一个新的 `summarizer` 技能，它负责接收URL，调用 `web_fetch`，然后将内容作为任务描述，通过 `sessions_spawn` 传递给摘要子Agent。
3.  **测试与集成**: 将这个新命令/技能，集成到我们的日常工作流中。

## 4. 成功衡量标准 (Metrics for Success)

我们如何知道这个项目是成功的？

1.  **成本显著降低**: 在执行相同数量和类型的任务后，通过 `session_status` 或服务商后台账单，观察到总成本有明确的、可量化的下降。
2.  **性能无感或可接受**: 对于那些被切换到 `Gemini-Flash` 的任务，其输出质量没有出现肉眼可见的、不可接受的下降。
3.  **流程自动化**: 模型调度的过程，绝大部分是自动发生的（通过Cron和子Agent），无需频繁的人工干预。

## 5. 风险评估

- **风险**: `Gemini-Flash` 模型在处理某些“看似简单”的任务时，可能会出现“能力不足”，导致输出质量下降。
- **缓解措施**: 
    - 我们采取“分阶段实施”的策略，从小范围、低风险的后台任务开始试点，充分验证后再扩大范围。
    - 保留“手动切换”的能力，如果发现子Agent或Cron任务的结果不佳，我们可以随时切换回 Pro 模型进行重试。

---

**下一步**: 等待您的批准，以启动 **Phase 1** 的实施。