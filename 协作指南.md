# 🤖 MOSS Assistant - 协作指南

> 帮助你与 Claude AI 长期协作维护 MOSS

---

## 📋 三大核心场景的解决方案

### 场景 1️⃣：对话丢失后，如何让 Claude 了解 MOSS？

**问题：** 当对话丢失后，Claude 不知道 MOSS 的存在

**解决方案：** 使用项目护照

#### ✅ 立即可用的方法

**当你打开新对话时，对 Claude 说：**

```
"我有一个项目 MOSS Assistant，请查看：
C:\Users\flyskyson\moss-assistant\PROJECT_PASSPORT.md"
```

Claude 会立即了解：
- ✅ MOSS 是什么
- ✅ 在哪里
- ✅ 如何使用
- ✅ 如何维护
- ✅ 未来计划

#### 📄 项目护照内容

`PROJECT_PASSPORT.md` 包含：
- 项目基本信息
- 技术栈和架构
- 快速启动命令
- 常见维护任务
- 用户定制配置
- Git 历史
- 未来计划

---

### 场景 2️⃣：如何让 MOSS 控制工作区文件管家？

**问题：** 希望两个智能体协同工作

**解决方案：** 使用外部智能体集成接口

#### 🔌 集成方式

**方法 1：直接调用（简单）**

在 `app.py` 或 `moss.py` 中：

```python
from core.integrations import WorkspaceManagerIntegration

# 创建管家实例
manager = WorkspaceManagerIntegration(
    manager_path="path/to/your/workspace/manager"
)

# 调用功能
result = manager.organize_files(".")
print(result)
```

**方法 2：通过 MOSS 调用（推荐）**

```python
# MOSS 已经集成了外部智能体管理器
moss = MOSSAssistant()

# 调用工作区管家
result = moss.call_external_agent(
    "workspace_manager",
    "organize_files",
    "."
)
```

#### 🎯 具体实施步骤

**步骤 1：** 配置工作区管家路径

编辑 `config.yaml`，添加：

```yaml
external_agents:
  workspace_manager:
    name: "工作区文件管家"
    enabled: true
    path: "path/to/your/workspace/manager"
```

**步骤 2：** 在 MOSS 中添加角色

添加一个"管家"角色，可以调用文件整理功能：

```yaml
roles:
  steward:
    name: "管家"
    enabled: true
    trigger_keywords:
      - "整理文件"
      - "文件管理"
    system_prompt: |
      你是管家，负责文件管理。
      当用户要求整理文件时，调用工作区管家...
```

**步骤 3：** 测试集成

```
你: 帮我整理当前目录的文件
MOSS: [调用工作区管家] 文件整理完成
```

---

### 场景 3️⃣：如何用 VS Code 工作区管理 MOSS？

**问题：** 希望在 VS Code 中更好地查看和管理 MOSS

**解决方案：** 使用 VS Code 工作区配置

#### 🎨 工作区功能

我已为你创建了 `moss-assistant.code-workspace`，包含：

**1. 多文件夹视图**
- 📁 MOSS Assistant（根目录）
- 📁 核心模块（core/）
- 📁 数据存储（data/）
- 📁 文档（docs/）

**2. 启动配置**
- 一键启动 MOSS（F5 调试）
- 运行 Streamlit
- 自动加载环境变量

**3. 快捷任务**
- 启动 MOSS
- 查看日志
- 备份数据
- 运行测试

#### 🚀 使用方法

**方式 1：双击打开**
```
双击文件：moss-assistant.code-workspace
```

**方式 2：VS Code 菜单**
```
File → Open Workspace from File...
选择：moss-assistant.code-workspace
```

**方式 3：命令行**
```bash
code moss-assistant.code-workspace
```

#### 📊 工作区界面

打开后你会看到：
- **左侧**：4 个独立的文件夹
- **底部**：集成的终端
- **左侧边栏**：运行和调试
- **右侧**：Git 管理器

---

## 🔧 日常维护工作流

### 每日维护（5 分钟）

```bash
# 1. 诊断状态
python diagnose.py

# 2. 如果有问题，查看日志
tail -100 streamlit.log

# 3. 启动 MOSS
python start_moss.py
```

### 每周维护（30 分钟）

```bash
# 1. 查看数据
ls -lh data/

# 2. 备份
cp -r data/ backups/data_$(date +%Y%m%d)/

# 3. 提交到 Git
git add .
git commit -m "weekly update"
git push
```

### 和 Claude 协作

**场景 A：诊断问题**
```
你: "诊断 MOSS 运行情况"
Claude: 运行 diagnose.py → 分析结果 → 提供解决方案
```

**场景 B：添加功能**
```
你: "让 MOSS 能调用工作区管家"
Claude: 设计接口 → 编写代码 → 测试验证
```

**场景 C：优化配置**
```
你: "优化导师角色的 prompt"
Claude: 分析现有配置 → 提出改进方案 → 实施优化
```

---

## 📚 快速参考卡片

### 给 Claude 的提示词模板

**诊断：**
```
"请诊断 C:\Users\flyskyson\moss-assistant 的运行情况"
```

**优化：**
```
"请优化 MOSS 的 XX 角色，配置文件在：
C:\Users\flyskyson\moss-assistant\config.yaml"
```

**集成：**
```
"让 MOSS 能调用工作区文件管家，
项目护照在：
C:\Users\flyskyson\moss-assistant\PROJECT_PASSPORT.md"
```

**查看：**
```
"在 VS Code 工作区中打开 MOSS 项目：
C:\Users\flyskyson\moss-assistant\moss-assistant.code-workspace"
```

---

## 🎯 核心文件清单

| 文件 | 作用 | 何时使用 |
|------|------|----------|
| `PROJECT_PASSPORT.md` | 🪪 项目身份证 | 对话丢失时 |
| `diagnose.py` | 🔍 诊断工具 | 检查状态时 |
| `moss-assistant.code-workspace` | 🎨 VS Code 工作区 | 开发管理时 |
| `start_moss.py` | 🚀 启动脚本 | 启动服务时 |
| `core/integrations.py` | 🔌 集成接口 | 连接其他智能体 |
| `config.yaml` | ⚙️ 配置文件 | 修改行为时 |

---

## 💡 最佳实践

### 1. 定期备份
- 每周备份 `data/` 目录
- 提交到 Git 私有仓库
- 使用云端存储

### 2. 文档先行
- 修改代码前先更新文档
- 记录重要决策
- 保留变更历史

### 3. 渐进迭代
- 小步快跑
- 频繁测试
- 及时提交

### 4. 与 Claude 协作
- 明确需求
- 提供上下文
- 验证结果

---

## 🎊 总结

现在你有了：

✅ **项目护照** - 对话丢失也不怕
✅ **诊断工具** - 快速检查健康状况
✅ **工作区配置** - VS Code 中高效管理
✅ **集成接口** - 连接其他智能体
✅ **协作指南** - 长期维护的方法论

---

**持续迭代，越来越好。🚀**

*最后更新：2025-01-10*
